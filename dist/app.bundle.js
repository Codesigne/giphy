!function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=4)}([function(t,n,e){var r=e(1);"string"==typeof r&&(r=[[t.i,r,""]]);var i={insert:"head",singleton:!1};e(3)(r,i);r.locals&&(t.exports=r.locals)},function(t,n,e){(t.exports=e(2)(!1)).push([t.i,"body {\r\n    margin: 0;\r\n    height: calc(100vh + 10px);\r\n}\r\n\r\n/* .modal {\r\n    display: none;\r\n  }\r\n  \r\n  .modal.is-open {\r\n    display: block;\r\n  } */\r\n         \r\n.gif {\r\n    height: 200px;\r\n    width:100%;\r\n    max-width: 200px;\r\n    cursor: pointer;\r\n}",""])},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=function(t,n){var e=t[1]||"",r=t[3];if(!r)return e;if(n&&"function"==typeof btoa){var i=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),a=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot).concat(t," */")}));return[e].concat(a).concat([i]).join("\n")}var o,s,c;return[e].join("\n")}(n,t);return n[2]?"@media ".concat(n[2],"{").concat(e,"}"):e})).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var a=this[i][0];null!=a&&(r[a]=!0)}for(var o=0;o<t.length;o++){var s=t[o];null!=s[0]&&r[s[0]]||(e&&!s[2]?s[2]=e:e&&(s[2]="(".concat(s[2],") and (").concat(e,")")),n.push(s))}},n}},function(t,n,e){"use strict";var r,i={},a=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[n]=e}return t[n]}}();function s(t,n){for(var e=[],r={},i=0;i<t.length;i++){var a=t[i],o=n.base?a[0]+n.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};r[o]?r[o].parts.push(s):e.push(r[o]={id:o,parts:[s]})}return e}function c(t,n){for(var e=0;e<t.length;e++){var r=t[e],a=i[r.id],o=0;if(a){for(a.refs++;o<a.parts.length;o++)a.parts[o](r.parts[o]);for(;o<r.parts.length;o++)a.parts.push(v(r.parts[o],n))}else{for(var s=[];o<r.parts.length;o++)s.push(v(r.parts[o],n));i[r.id]={id:r.id,refs:1,parts:s}}}}function u(t){var n=document.createElement("style");if(void 0===t.attributes.nonce){var r=e.nc;r&&(t.attributes.nonce=r)}if(Object.keys(t.attributes).forEach((function(e){n.setAttribute(e,t.attributes[e])})),"function"==typeof t.insert)t.insert(n);else{var i=o(t.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}return n}var l,f=(l=[],function(t,n){return l[t]=n,l.filter(Boolean).join("\n")});function p(t,n,e,r){var i=e?"":r.css;if(t.styleSheet)t.styleSheet.cssText=f(n,i);else{var a=document.createTextNode(i),o=t.childNodes;o[n]&&t.removeChild(o[n]),o.length?t.insertBefore(a,o[n]):t.appendChild(a)}}function d(t,n,e){var r=e.css,i=e.media,a=e.sourceMap;if(i&&t.setAttribute("media",i),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var h=null,g=0;function v(t,n){var e,r,i;if(n.singleton){var a=g++;e=h||(h=u(n)),r=p.bind(null,e,a,!1),i=p.bind(null,e,a,!0)}else e=u(n),r=d.bind(null,e,n),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else i()}}t.exports=function(t,n){(n=n||{}).attributes="object"==typeof n.attributes?n.attributes:{},n.singleton||"boolean"==typeof n.singleton||(n.singleton=a());var e=s(t,n);return c(e,n),function(t){for(var r=[],a=0;a<e.length;a++){var o=e[a],u=i[o.id];u&&(u.refs--,r.push(u))}t&&c(s(t,n),n);for(var l=0;l<r.length;l++){var f=r[l];if(0===f.refs){for(var p=0;p<f.parts.length;p++)f.parts[p]();delete i[f.id]}}}}},function(t,n,e){"use strict";e.r(n);var r={activeGif:"",searchValue:"",activeApi:"trending",trending:{pagination:{total_count:null,count:null,offset:0,response_pending:!1}},search:{pagination:{total_count:null,count:null,offset:0,response_pending:!1}}};const i="https://api.giphy.com/v1/gifs",a="rXduKJTlpl96RvM2HsHtlvGh01YYMZD2";e(0);const o=$("[data-template='gifHolder']  img").clone(!0,!0);function s(t,n){r[n].pagination.response_pending=!1,Object.assign(r[n].pagination,{...t.pagination}),t.pagination.total_count>0?t.data.forEach((function(t,n){let e=o.clone(1,1);e.attr({src:t.images.fixed_width_downsampled.webp,id:t.id,"data-details":JSON.stringify(t)}),$("[data-result]").append(e)})):$("[data-result]").append(`No result for ${r.searchValue}`)}function c(t){return()=>{if((null==r[t].pagination.total_count||r[t].pagination.offset+r[t].pagination.offset<r[t].pagination.total_count)&&1!=r[t].pagination.response_pending){switch(t){case"search":(function(t){return $.ajax({url:`${i}/search?api_key=${a}&q=${r.searchValue}&limit=5&offset=${r.search.pagination.offset+5}&rating=G&lang=en`})})().then(n=>{s(n,t)},t=>{$("[data-result]").append("Something went wrong")});break;case"trending":(function(t){return $.ajax({url:`${i}/trending?api_key=${a}&q=prafull&limit=5&offset=${r.trending.pagination.offset+5}`})})().then(n=>{s(n,t)},t=>{$("[data-result]").append("Something went wrong")})}r[t].pagination.response_pending=!0}}}var u=c("search"),l=c("trending");function f(t){switch(t){case"search":u();break;case"trending":default:l()}}$("#inputeSearch").on("input",(function(t){t.preventDefault(),""==this.value?r.activeApi="trending":(r.searchValue=this.value,r.activeApi="search")})),$("#seachGify").on("click",(function(t){t.preventDefault(),$("[data-result]").empty(),r.search.pagination.offset=0,r.trending.pagination.offset=0,f(r.activeApi)})),$(window).on("scroll",(function(t){t.preventDefault(),console.log(r),Math.floor($(this).scrollTop())+10>=$(document).height()-$(window).height()&&f(r.activeApi)})),$("body").on("click",".gif",(function(){r.activeGif=this.id})),l()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLmNzcz85ODE5Iiwid2VicGFjazovLy8uL3NyYy9zdHlsZS5jc3MiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0b3JlLmpzIiwid2VicGFjazovLy8uL3NyYy9BUEkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY29udGVudCIsIm9wdGlvbnMiLCJsb2NhbHMiLCJwdXNoIiwidXNlU291cmNlTWFwIiwibGlzdCIsInRvU3RyaW5nIiwidGhpcyIsIm1hcCIsIml0ZW0iLCJjc3NNYXBwaW5nIiwiYnRvYSIsInNvdXJjZU1hcHBpbmciLCJzb3VyY2VNYXAiLCJiYXNlNjQiLCJ1bmVzY2FwZSIsImVuY29kZVVSSUNvbXBvbmVudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJkYXRhIiwiY29uY2F0Iiwic291cmNlVVJMcyIsInNvdXJjZXMiLCJzb3VyY2UiLCJzb3VyY2VSb290Iiwiam9pbiIsImNzc1dpdGhNYXBwaW5nVG9TdHJpbmciLCJtZWRpYVF1ZXJ5IiwiYWxyZWFkeUltcG9ydGVkTW9kdWxlcyIsImxlbmd0aCIsImlkIiwiX2kiLCJtZW1vIiwic3R5bGVzSW5Eb20iLCJpc09sZElFIiwiQm9vbGVhbiIsIndpbmRvdyIsImRvY3VtZW50IiwiYWxsIiwiYXRvYiIsImdldFRhcmdldCIsInRhcmdldCIsInN0eWxlVGFyZ2V0IiwicXVlcnlTZWxlY3RvciIsIkhUTUxJRnJhbWVFbGVtZW50IiwiY29udGVudERvY3VtZW50IiwiaGVhZCIsImUiLCJsaXN0VG9TdHlsZXMiLCJzdHlsZXMiLCJuZXdTdHlsZXMiLCJiYXNlIiwicGFydCIsImNzcyIsIm1lZGlhIiwicGFydHMiLCJhZGRTdHlsZXNUb0RvbSIsImRvbVN0eWxlIiwiaiIsInJlZnMiLCJhZGRTdHlsZSIsImluc2VydFN0eWxlRWxlbWVudCIsInN0eWxlIiwiY3JlYXRlRWxlbWVudCIsImF0dHJpYnV0ZXMiLCJub25jZSIsImtleXMiLCJmb3JFYWNoIiwic2V0QXR0cmlidXRlIiwiaW5zZXJ0IiwiRXJyb3IiLCJhcHBlbmRDaGlsZCIsInRleHRTdG9yZSIsInJlcGxhY2VUZXh0IiwiaW5kZXgiLCJyZXBsYWNlbWVudCIsImZpbHRlciIsImFwcGx5VG9TaW5nbGV0b25UYWciLCJyZW1vdmUiLCJvYmoiLCJzdHlsZVNoZWV0IiwiY3NzVGV4dCIsImNzc05vZGUiLCJjcmVhdGVUZXh0Tm9kZSIsImNoaWxkTm9kZXMiLCJyZW1vdmVDaGlsZCIsImluc2VydEJlZm9yZSIsImFwcGx5VG9UYWciLCJmaXJzdENoaWxkIiwic2luZ2xldG9uIiwic2luZ2xldG9uQ291bnRlciIsInVwZGF0ZSIsInN0eWxlSW5kZXgiLCJwYXJlbnROb2RlIiwicmVtb3ZlU3R5bGVFbGVtZW50IiwibmV3T2JqIiwibmV3TGlzdCIsIm1heVJlbW92ZSIsIl9kb21TdHlsZSIsIlN0b3JlIiwiYWN0aXZlR2lmIiwic2VhcmNoVmFsdWUiLCJhY3RpdmVBcGkiLCJ0cmVuZGluZyIsInBhZ2luYXRpb24iLCJ0b3RhbF9jb3VudCIsImNvdW50Iiwib2Zmc2V0IiwicmVzcG9uc2VfcGVuZGluZyIsInNlYXJjaCIsImJhc2VVcmwiLCJhcGlfa2V5IiwiJGdpZkhvbGRlciIsIiQiLCJjbG9uZSIsIm9uU3VjY2VzIiwicmVzcG9uc2UiLCJhcGlOYW1lIiwiYXNzaWduIiwiZWwiLCIkZ2lmSG9sZGVySW5zdGFuY2UiLCJhdHRyIiwiaW1hZ2VzIiwiZml4ZWRfd2lkdGhfZG93bnNhbXBsZWQiLCJ3ZWJwIiwiYXBwZW5kIiwiZ2V0TGlzdE9mIiwiYXJndW1lbnQiLCJhamF4IiwidXJsIiwidGhlbiIsImVycm9yIiwiZ2V0TGlzdE9mQWN0aXZlQXBpIiwib24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiZW1wdHkiLCJjb25zb2xlIiwibG9nIiwiTWF0aCIsImZsb29yIiwic2Nyb2xsVG9wIiwiaGVpZ2h0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9D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QU1HLFVBQVksYUFHMUJXLEVBQUUsY0FBY29CLEdBQUcsU0FBUyxTQUFVQyxHQUNsQ0EsRUFBTUMsaUJBRU50QixFQUFFLGlCQUFpQnVCLFFBQ25CckMsRUFBTVUsT0FBT0wsV0FBV0csT0FBUyxFQUNqQ1IsRUFBTUksU0FBU0MsV0FBV0csT0FBUyxFQUNuQ3lCLEVBQW1CakMsRUFBTUcsY0FHN0JXLEVBQUU3RSxRQUFRaUcsR0FBRyxVQUFVLFNBQVVDLEdBQzdCQSxFQUFNQyxpQkFFTkUsUUFBUUMsSUFBSXZDLEdBQ1J3QyxLQUFLQyxNQUFNM0IsRUFBRTFHLE1BQU1zSSxhQUFlLElBQVE1QixFQUFFNUUsVUFBVXlHLFNBQVk3QixFQUFFN0UsUUFBUTBHLFVBQzVFVixFQUFtQmpDLEVBQU1HLGNBSWpDVyxFQUFFLFFBQVFvQixHQUFHLFFBQVMsUUFBUSxXQUMxQmxDLEVBQU1DLFVBQVk3RixLQUFLdUIsTUFJM0IiLCJmaWxlIjoiYXBwLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0KTtcbiIsInZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9zdHlsZS5jc3NcIik7XG5cbmlmICh0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xufVxuXG52YXIgb3B0aW9ucyA9IHt9XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIikoY29udGVudCwgb3B0aW9ucyk7XG5cbmlmIChjb250ZW50LmxvY2Fscykge1xuICBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xufVxuIiwiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIikoZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJib2R5IHtcXHJcXG4gICAgbWFyZ2luOiAwO1xcclxcbiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggKyAxMHB4KTtcXHJcXG59XFxyXFxuXFxyXFxuLyogLm1vZGFsIHtcXHJcXG4gICAgZGlzcGxheTogbm9uZTtcXHJcXG4gIH1cXHJcXG4gIFxcclxcbiAgLm1vZGFsLmlzLW9wZW4ge1xcclxcbiAgICBkaXNwbGF5OiBibG9jaztcXHJcXG4gIH0gKi9cXHJcXG4gICAgICAgICBcXHJcXG4uZ2lmIHtcXHJcXG4gICAgaGVpZ2h0OiAyMDBweDtcXHJcXG4gICAgd2lkdGg6MTAwJTtcXHJcXG4gICAgbWF4LXdpZHRoOiAyMDBweDtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbn1cIiwgXCJcIl0pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qXG4gIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG4gIEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZ1bmMtbmFtZXNcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHVzZVNvdXJjZU1hcCkge1xuICB2YXIgbGlzdCA9IFtdOyAvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXG5cbiAgbGlzdC50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgdmFyIGNvbnRlbnQgPSBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0sIHVzZVNvdXJjZU1hcCk7XG5cbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIHJldHVybiBcIkBtZWRpYSBcIi5jb25jYXQoaXRlbVsyXSwgXCJ7XCIpLmNvbmNhdChjb250ZW50LCBcIn1cIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH0pLmpvaW4oJycpO1xuICB9OyAvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuXG5cbiAgbGlzdC5pID0gZnVuY3Rpb24gKG1vZHVsZXMsIG1lZGlhUXVlcnkpIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsICcnXV07XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1kZXN0cnVjdHVyaW5nXG4gICAgICB2YXIgaWQgPSB0aGlzW2ldWzBdO1xuXG4gICAgICBpZiAoaWQgIT0gbnVsbCkge1xuICAgICAgICBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2lkXSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG1vZHVsZXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IG1vZHVsZXNbX2ldOyAvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXG4gICAgICAvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xuICAgICAgLy8gd2hlbiBhIG1vZHVsZSBpcyBpbXBvcnRlZCBtdWx0aXBsZSB0aW1lcyB3aXRoIGRpZmZlcmVudCBtZWRpYSBxdWVyaWVzLlxuICAgICAgLy8gSSBob3BlIHRoaXMgd2lsbCBuZXZlciBvY2N1ciAoSGV5IHRoaXMgd2F5IHdlIGhhdmUgc21hbGxlciBidW5kbGVzKVxuXG4gICAgICBpZiAoaXRlbVswXSA9PSBudWxsIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XG4gICAgICAgIGlmIChtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XG4gICAgICAgICAgaXRlbVsyXSA9IG1lZGlhUXVlcnk7XG4gICAgICAgIH0gZWxzZSBpZiAobWVkaWFRdWVyeSkge1xuICAgICAgICAgIGl0ZW1bMl0gPSBcIihcIi5jb25jYXQoaXRlbVsyXSwgXCIpIGFuZCAoXCIpLmNvbmNhdChtZWRpYVF1ZXJ5LCBcIilcIik7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0LnB1c2goaXRlbSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBsaXN0O1xufTtcblxuZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcbiAgdmFyIGNvbnRlbnQgPSBpdGVtWzFdIHx8ICcnOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcblxuICB2YXIgY3NzTWFwcGluZyA9IGl0ZW1bM107XG5cbiAgaWYgKCFjc3NNYXBwaW5nKSB7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cblxuICBpZiAodXNlU291cmNlTWFwICYmIHR5cGVvZiBidG9hID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFyIHNvdXJjZU1hcHBpbmcgPSB0b0NvbW1lbnQoY3NzTWFwcGluZyk7XG4gICAgdmFyIHNvdXJjZVVSTHMgPSBjc3NNYXBwaW5nLnNvdXJjZXMubWFwKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgIHJldHVybiBcIi8qIyBzb3VyY2VVUkw9XCIuY29uY2F0KGNzc01hcHBpbmcuc291cmNlUm9vdCkuY29uY2F0KHNvdXJjZSwgXCIgKi9cIik7XG4gICAgfSk7XG4gICAgcmV0dXJuIFtjb250ZW50XS5jb25jYXQoc291cmNlVVJMcykuY29uY2F0KFtzb3VyY2VNYXBwaW5nXSkuam9pbignXFxuJyk7XG4gIH1cblxuICByZXR1cm4gW2NvbnRlbnRdLmpvaW4oJ1xcbicpO1xufSAvLyBBZGFwdGVkIGZyb20gY29udmVydC1zb3VyY2UtbWFwIChNSVQpXG5cblxuZnVuY3Rpb24gdG9Db21tZW50KHNvdXJjZU1hcCkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgdmFyIGJhc2U2NCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSk7XG4gIHZhciBkYXRhID0gXCJzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCxcIi5jb25jYXQoYmFzZTY0KTtcbiAgcmV0dXJuIFwiLyojIFwiLmNvbmNhdChkYXRhLCBcIiAqL1wiKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIHN0eWxlc0luRG9tID0ge307XG5cbnZhciBpc09sZElFID0gZnVuY3Rpb24gaXNPbGRJRSgpIHtcbiAgdmFyIG1lbW87XG4gIHJldHVybiBmdW5jdGlvbiBtZW1vcml6ZSgpIHtcbiAgICBpZiAodHlwZW9mIG1lbW8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvLyBUZXN0IGZvciBJRSA8PSA5IGFzIHByb3Bvc2VkIGJ5IEJyb3dzZXJoYWNrc1xuICAgICAgLy8gQHNlZSBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1lNzFkODY5MmY2NTMzNDE3M2ZlZTcxNWMyMjJjYjgwNVxuICAgICAgLy8gVGVzdHMgZm9yIGV4aXN0ZW5jZSBvZiBzdGFuZGFyZCBnbG9iYWxzIGlzIHRvIGFsbG93IHN0eWxlLWxvYWRlclxuICAgICAgLy8gdG8gb3BlcmF0ZSBjb3JyZWN0bHkgaW50byBub24tc3RhbmRhcmQgZW52aXJvbm1lbnRzXG4gICAgICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrLWNvbnRyaWIvc3R5bGUtbG9hZGVyL2lzc3Vlcy8xNzdcbiAgICAgIG1lbW8gPSBCb29sZWFuKHdpbmRvdyAmJiBkb2N1bWVudCAmJiBkb2N1bWVudC5hbGwgJiYgIXdpbmRvdy5hdG9iKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtbztcbiAgfTtcbn0oKTtcblxudmFyIGdldFRhcmdldCA9IGZ1bmN0aW9uIGdldFRhcmdldCgpIHtcbiAgdmFyIG1lbW8gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9yaXplKHRhcmdldCkge1xuICAgIGlmICh0eXBlb2YgbWVtb1t0YXJnZXRdID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdmFyIHN0eWxlVGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyAvLyBTcGVjaWFsIGNhc2UgdG8gcmV0dXJuIGhlYWQgb2YgaWZyYW1lIGluc3RlYWQgb2YgaWZyYW1lIGl0c2VsZlxuXG4gICAgICBpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcbiAgICAgICAgICAvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gc3R5bGVUYXJnZXQuY29udGVudERvY3VtZW50LmhlYWQ7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBpc3RhbmJ1bCBpZ25vcmUgbmV4dFxuICAgICAgICAgIHN0eWxlVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtZW1vW3RhcmdldF0gPSBzdHlsZVRhcmdldDtcbiAgICB9XG5cbiAgICByZXR1cm4gbWVtb1t0YXJnZXRdO1xuICB9O1xufSgpO1xuXG5mdW5jdGlvbiBsaXN0VG9TdHlsZXMobGlzdCwgb3B0aW9ucykge1xuICB2YXIgc3R5bGVzID0gW107XG4gIHZhciBuZXdTdHlsZXMgPSB7fTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgdmFyIGlkID0gb3B0aW9ucy5iYXNlID8gaXRlbVswXSArIG9wdGlvbnMuYmFzZSA6IGl0ZW1bMF07XG4gICAgdmFyIGNzcyA9IGl0ZW1bMV07XG4gICAgdmFyIG1lZGlhID0gaXRlbVsyXTtcbiAgICB2YXIgc291cmNlTWFwID0gaXRlbVszXTtcbiAgICB2YXIgcGFydCA9IHtcbiAgICAgIGNzczogY3NzLFxuICAgICAgbWVkaWE6IG1lZGlhLFxuICAgICAgc291cmNlTWFwOiBzb3VyY2VNYXBcbiAgICB9O1xuXG4gICAgaWYgKCFuZXdTdHlsZXNbaWRdKSB7XG4gICAgICBzdHlsZXMucHVzaChuZXdTdHlsZXNbaWRdID0ge1xuICAgICAgICBpZDogaWQsXG4gICAgICAgIHBhcnRzOiBbcGFydF1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0eWxlcztcbn1cblxuZnVuY3Rpb24gYWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGl0ZW0gPSBzdHlsZXNbaV07XG4gICAgdmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XG4gICAgdmFyIGogPSAwO1xuXG4gICAgaWYgKGRvbVN0eWxlKSB7XG4gICAgICBkb21TdHlsZS5yZWZzKys7XG5cbiAgICAgIGZvciAoOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuICAgICAgICBkb21TdHlsZS5wYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHBhcnRzID0gW107XG5cbiAgICAgIGZvciAoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xuICAgICAgICBwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcbiAgICAgIH1cblxuICAgICAgc3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7XG4gICAgICAgIGlkOiBpdGVtLmlkLFxuICAgICAgICByZWZzOiAxLFxuICAgICAgICBwYXJ0czogcGFydHNcbiAgICAgIH07XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSB7XG4gIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG5cbiAgaWYgKHR5cGVvZiBvcHRpb25zLmF0dHJpYnV0ZXMubm9uY2UgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgdmFyIG5vbmNlID0gdHlwZW9mIF9fd2VicGFja19ub25jZV9fICE9PSAndW5kZWZpbmVkJyA/IF9fd2VicGFja19ub25jZV9fIDogbnVsbDtcblxuICAgIGlmIChub25jZSkge1xuICAgICAgb3B0aW9ucy5hdHRyaWJ1dGVzLm5vbmNlID0gbm9uY2U7XG4gICAgfVxuICB9XG5cbiAgT2JqZWN0LmtleXMob3B0aW9ucy5hdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoa2V5LCBvcHRpb25zLmF0dHJpYnV0ZXNba2V5XSk7XG4gIH0pO1xuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBvcHRpb25zLmluc2VydChzdHlsZSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRhcmdldCA9IGdldFRhcmdldChvcHRpb25zLmluc2VydCB8fCAnaGVhZCcpO1xuXG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkbid0IGZpbmQgYSBzdHlsZSB0YXJnZXQuIFRoaXMgcHJvYmFibHkgbWVhbnMgdGhhdCB0aGUgdmFsdWUgZm9yIHRoZSAnaW5zZXJ0JyBwYXJhbWV0ZXIgaXMgaW52YWxpZC5cIik7XG4gICAgfVxuXG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuXG4gIHJldHVybiBzdHlsZTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKSB7XG4gIC8vIGlzdGFuYnVsIGlnbm9yZSBpZlxuICBpZiAoc3R5bGUucGFyZW50Tm9kZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHN0eWxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGUpO1xufVxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgICovXG5cblxudmFyIHJlcGxhY2VUZXh0ID0gZnVuY3Rpb24gcmVwbGFjZVRleHQoKSB7XG4gIHZhciB0ZXh0U3RvcmUgPSBbXTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcGxhY2UoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG4gICAgdGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xuICAgIHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xuICB9O1xufSgpO1xuXG5mdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnKHN0eWxlLCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcbiAgdmFyIGNzcyA9IHJlbW92ZSA/ICcnIDogb2JqLmNzczsgLy8gRm9yIG9sZCBJRVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAgKi9cblxuICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuICB9IGVsc2Uge1xuICAgIHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcbiAgICB2YXIgY2hpbGROb2RlcyA9IHN0eWxlLmNoaWxkTm9kZXM7XG5cbiAgICBpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHtcbiAgICAgIHN0eWxlLnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcbiAgICB9XG5cbiAgICBpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgIHN0eWxlLmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGNzc05vZGUpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlLCBvcHRpb25zLCBvYmopIHtcbiAgdmFyIGNzcyA9IG9iai5jc3M7XG4gIHZhciBtZWRpYSA9IG9iai5tZWRpYTtcbiAgdmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XG5cbiAgaWYgKG1lZGlhKSB7XG4gICAgc3R5bGUuc2V0QXR0cmlidXRlKCdtZWRpYScsIG1lZGlhKTtcbiAgfVxuXG4gIGlmIChzb3VyY2VNYXAgJiYgYnRvYSkge1xuICAgIGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIuY29uY2F0KGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSksIFwiICovXCIpO1xuICB9IC8vIEZvciBvbGQgSUVcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cblxuICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcbiAgfSBlbHNlIHtcbiAgICB3aGlsZSAoc3R5bGUuZmlyc3RDaGlsZCkge1xuICAgICAgc3R5bGUucmVtb3ZlQ2hpbGQoc3R5bGUuZmlyc3RDaGlsZCk7XG4gICAgfVxuXG4gICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG4gIH1cbn1cblxudmFyIHNpbmdsZXRvbiA9IG51bGw7XG52YXIgc2luZ2xldG9uQ291bnRlciA9IDA7XG5cbmZ1bmN0aW9uIGFkZFN0eWxlKG9iaiwgb3B0aW9ucykge1xuICB2YXIgc3R5bGU7XG4gIHZhciB1cGRhdGU7XG4gIHZhciByZW1vdmU7XG5cbiAgaWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XG4gICAgdmFyIHN0eWxlSW5kZXggPSBzaW5nbGV0b25Db3VudGVyKys7XG4gICAgc3R5bGUgPSBzaW5nbGV0b24gfHwgKHNpbmdsZXRvbiA9IGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSk7XG4gICAgdXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlLCBzdHlsZUluZGV4LCBmYWxzZSk7XG4gICAgcmVtb3ZlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlLCBzdHlsZUluZGV4LCB0cnVlKTtcbiAgfSBlbHNlIHtcbiAgICBzdHlsZSA9IGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKTtcbiAgICB1cGRhdGUgPSBhcHBseVRvVGFnLmJpbmQobnVsbCwgc3R5bGUsIG9wdGlvbnMpO1xuXG4gICAgcmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgcmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKTtcbiAgICB9O1xuICB9XG5cbiAgdXBkYXRlKG9iaik7XG4gIHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcbiAgICBpZiAobmV3T2JqKSB7XG4gICAgICBpZiAobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlKG9iaiA9IG5ld09iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbW92ZSgpO1xuICAgIH1cbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobGlzdCwgb3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgb3B0aW9ucy5hdHRyaWJ1dGVzID0gdHlwZW9mIG9wdGlvbnMuYXR0cmlidXRlcyA9PT0gJ29iamVjdCcgPyBvcHRpb25zLmF0dHJpYnV0ZXMgOiB7fTsgLy8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XG4gIC8vIHRhZ3MgaXQgd2lsbCBhbGxvdyBvbiBhIHBhZ2VcblxuICBpZiAoIW9wdGlvbnMuc2luZ2xldG9uICYmIHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XG4gIH1cblxuICB2YXIgc3R5bGVzID0gbGlzdFRvU3R5bGVzKGxpc3QsIG9wdGlvbnMpO1xuICBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xuICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcbiAgICB2YXIgbWF5UmVtb3ZlID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGl0ZW0gPSBzdHlsZXNbaV07XG4gICAgICB2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcblxuICAgICAgaWYgKGRvbVN0eWxlKSB7XG4gICAgICAgIGRvbVN0eWxlLnJlZnMtLTtcbiAgICAgICAgbWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChuZXdMaXN0KSB7XG4gICAgICB2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QsIG9wdGlvbnMpO1xuICAgICAgYWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgbWF5UmVtb3ZlLmxlbmd0aDsgX2krKykge1xuICAgICAgdmFyIF9kb21TdHlsZSA9IG1heVJlbW92ZVtfaV07XG5cbiAgICAgIGlmIChfZG9tU3R5bGUucmVmcyA9PT0gMCkge1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IF9kb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIF9kb21TdHlsZS5wYXJ0c1tqXSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVsZXRlIHN0eWxlc0luRG9tW19kb21TdHlsZS5pZF07XG4gICAgICB9XG4gICAgfVxuICB9O1xufTsiLCJleHBvcnQgdmFyIFN0b3JlID0ge1xyXG4gICAgYWN0aXZlR2lmOlwiXCIsXHJcbiAgICBzZWFyY2hWYWx1ZTpcIlwiLFxyXG5cdGFjdGl2ZUFwaTondHJlbmRpbmcnLFxyXG4gICAgdHJlbmRpbmc6IHtcclxuICAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgICAgIC8vIGxpbWl0OjJudWxsLFxyXG4gICAgICAgICAgICB0b3RhbF9jb3VudDogbnVsbCxcclxuICAgICAgICAgICAgY291bnQ6IG51bGwsXHJcbiAgICAgICAgICAgIG9mZnNldDowLFxyXG4gICAgICAgICAgICByZXNwb25zZV9wZW5kaW5nOmZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNlYXJjaDoge1xyXG4gICAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICAgICAgLy8gbGltaXQ6Mm51bGwseGNcclxuICAgICAgICAgICAgdG90YWxfY291bnQ6IG51bGwsXHJcbiAgICAgICAgICAgIGNvdW50OiBudWxsLFxyXG4gICAgICAgICAgICBvZmZzZXQ6MCxcclxuICAgICAgICAgICAgcmVzcG9uc2VfcGVuZGluZzpmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBTdG9yZSB9IGZyb20gJy4vc3RvcmUnXHJcblxyXG5jb25zdCBiYXNlVXJsID0gXCJodHRwczovL2FwaS5naXBoeS5jb20vdjEvZ2lmc1wiO1xyXG5jb25zdCBhcGlfa2V5ID0gXCJyWGR1S0pUbHBsOTZSdk0ySHNIdGx2R2gwMVlZTVpEMlwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlYXJjaExpc3QoYXJndW1lbnQpIHtcclxuXHRyZXR1cm4gJC5hamF4KHtcclxuXHRcdHVybDogYCR7YmFzZVVybH0vc2VhcmNoP2FwaV9rZXk9JHthcGlfa2V5fSZxPSR7U3RvcmUuc2VhcmNoVmFsdWV9JmxpbWl0PTUmb2Zmc2V0PSR7U3RvcmUuc2VhcmNoLnBhZ2luYXRpb24ub2Zmc2V0ICsgNX0mcmF0aW5nPUcmbGFuZz1lbmAsXHJcblx0fSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyZW5kaW5nTGlzdChhcmd1bWVudCkge1xyXG5cdHJldHVybiAkLmFqYXgoe1xyXG5cdFx0dXJsOiBgJHtiYXNlVXJsfS90cmVuZGluZz9hcGlfa2V5PSR7YXBpX2tleX0mcT1wcmFmdWxsJmxpbWl0PTUmb2Zmc2V0PSR7U3RvcmUudHJlbmRpbmcucGFnaW5hdGlvbi5vZmZzZXQgKyA1fWAsXHJcblx0fSlcclxufVxyXG4vKipcclxuICogXHJcbiAqIFJldHVybnMgc2FtZSBkYXRhIHJlbGF0ZCB0byBnaWYgYXMgaXQgaXMgaW4gYWJvdmUgdHdvIGxpc3QgZnVuY3Rpb25zIFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RJdGVtKGFyZ3VtZW50KSB7XHJcblx0cmV0dXJuICQuYWpheCh7XHJcblx0XHR1cmw6IGAke2Jhc2VVcmx9LyR7U3RvcmUuYWN0aXZlR2lmfT9hcGlfa2V5PSR7YXBpX2tleX1gLFxyXG5cdH0pXHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFN0b3JlIH0gZnJvbSAnLi9zdG9yZSdcclxuaW1wb3J0ICogYXMgQVBJIGZyb20gJy4vQVBJJ1xyXG5pbXBvcnQgJy4vc3R5bGUuY3NzJztcclxuXHJcbmNvbnN0ICRnaWZIb2xkZXIgPSAkKFwiW2RhdGEtdGVtcGxhdGU9J2dpZkhvbGRlciddICBpbWdcIikuY2xvbmUoITAsICEwKVxyXG5cclxuZnVuY3Rpb24gb25TdWNjZXMocmVzcG9uc2UsIGFwaU5hbWUpIHtcclxuICAgIFN0b3JlW2FwaU5hbWVdLnBhZ2luYXRpb24ucmVzcG9uc2VfcGVuZGluZyA9IGZhbHNlO1xyXG4gICAgT2JqZWN0LmFzc2lnbihTdG9yZVthcGlOYW1lXS5wYWdpbmF0aW9uLCB7IC4uLnJlc3BvbnNlLnBhZ2luYXRpb24gfSlcclxuICAgIGlmIChyZXNwb25zZS5wYWdpbmF0aW9uLnRvdGFsX2NvdW50ID4gMCkge1xyXG4gICAgICAgIHJlc3BvbnNlLmRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWwsIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGxldCAkZ2lmSG9sZGVySW5zdGFuY2UgPSAkZ2lmSG9sZGVyLmNsb25lKDEsIDEpXHJcbiAgICAgICAgICAgICRnaWZIb2xkZXJJbnN0YW5jZS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICdzcmMnOiBlbC5pbWFnZXMuZml4ZWRfd2lkdGhfZG93bnNhbXBsZWQud2VicCxcclxuICAgICAgICAgICAgICAgICdpZCc6IGVsLmlkLFxyXG4gICAgICAgICAgICAgICAgJ2RhdGEtZGV0YWlscyc6IEpTT04uc3RyaW5naWZ5KGVsKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJCgnW2RhdGEtcmVzdWx0XScpLmFwcGVuZCgkZ2lmSG9sZGVySW5zdGFuY2UpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQoJ1tkYXRhLXJlc3VsdF0nKS5hcHBlbmQoYE5vIHJlc3VsdCBmb3IgJHtTdG9yZS5zZWFyY2hWYWx1ZX1gKVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldExpc3RPZihhcGlOYW1lKSB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgKFxyXG4gICAgICAgICAgICAgICAgU3RvcmVbYXBpTmFtZV0ucGFnaW5hdGlvbi50b3RhbF9jb3VudCA9PSBudWxsIHx8XHJcbiAgICAgICAgICAgICAgICBTdG9yZVthcGlOYW1lXS5wYWdpbmF0aW9uLm9mZnNldCArIFN0b3JlW2FwaU5hbWVdLnBhZ2luYXRpb24ub2Zmc2V0IDwgU3RvcmVbYXBpTmFtZV0ucGFnaW5hdGlvbi50b3RhbF9jb3VudFxyXG4gICAgICAgICAgICApICYmXHJcbiAgICAgICAgICAgIFN0b3JlW2FwaU5hbWVdLnBhZ2luYXRpb24ucmVzcG9uc2VfcGVuZGluZyAhPSB0cnVlXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoYXBpTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VhcmNoJzpcclxuICAgICAgICAgICAgICAgICAgICBBUEkuZ2V0U2VhcmNoTGlzdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc3BvbnNlKSA9PiB7IG9uU3VjY2VzKHJlc3BvbnNlLCBhcGlOYW1lKSB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7ICQoJ1tkYXRhLXJlc3VsdF0nKS5hcHBlbmQoYFNvbWV0aGluZyB3ZW50IHdyb25nYCkgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndHJlbmRpbmcnOlxyXG4gICAgICAgICAgICAgICAgICAgIEFQSS5nZXRUcmVuZGluZ0xpc3QoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChyZXNwb25zZSkgPT4geyBvblN1Y2NlcyhyZXNwb25zZSwgYXBpTmFtZSkgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvcikgPT4geyAkKCdbZGF0YS1yZXN1bHRdJykuYXBwZW5kKGBTb21ldGhpbmcgd2VudCB3cm9uZ2ApIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBTdG9yZVthcGlOYW1lXS5wYWdpbmF0aW9uLnJlc3BvbnNlX3BlbmRpbmcgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG52YXIgZ2V0U2VhcmNoTGlzdCA9IGdldExpc3RPZignc2VhcmNoJyk7XHJcbnZhciBnZXRUcmVuZGluZ0xpc3QgPSBnZXRMaXN0T2YoJ3RyZW5kaW5nJyk7XHJcblxyXG5mdW5jdGlvbiBnZXRMaXN0T2ZBY3RpdmVBcGkoYWN0aXZlQXBpKSB7XHJcbiAgICBzd2l0Y2ggKGFjdGl2ZUFwaSkge1xyXG4gICAgICAgIGNhc2UgJ3NlYXJjaCc6XHJcbiAgICAgICAgICAgIGdldFNlYXJjaExpc3QoKVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICd0cmVuZGluZyc6XHJcbiAgICAgICAgICAgIGdldFRyZW5kaW5nTGlzdCgpXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGdldFRyZW5kaW5nTGlzdCgpXHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59XHJcblxyXG4kKCcjaW5wdXRlU2VhcmNoJykub24oJ2lucHV0JywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLyogQWN0IG9uIHRoZSBldmVudCAqL1xyXG4gICAgaWYgKHRoaXMudmFsdWUgPT0gXCJcIikge1xyXG4gICAgICAgIFN0b3JlLmFjdGl2ZUFwaSA9ICd0cmVuZGluZydcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgU3RvcmUuc2VhcmNoVmFsdWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgIFN0b3JlLmFjdGl2ZUFwaSA9ICdzZWFyY2gnXHJcbiAgICB9XHJcbn0pO1xyXG4kKCcjc2VhY2hHaWZ5Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLyogQWN0IG9uIHRoZSBldmVudCAqL1xyXG4gICAgJCgnW2RhdGEtcmVzdWx0XScpLmVtcHR5KCk7XHJcbiAgICBTdG9yZS5zZWFyY2gucGFnaW5hdGlvbi5vZmZzZXQgPSAwO1xyXG4gICAgU3RvcmUudHJlbmRpbmcucGFnaW5hdGlvbi5vZmZzZXQgPSAwO1xyXG4gICAgZ2V0TGlzdE9mQWN0aXZlQXBpKFN0b3JlLmFjdGl2ZUFwaSlcclxufSk7XHJcblxyXG4kKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIC8qIEFjdCBvbiB0aGUgZXZlbnQgKi9cclxuICAgIGNvbnNvbGUubG9nKFN0b3JlKTtcclxuICAgIGlmIChNYXRoLmZsb29yKCQodGhpcykuc2Nyb2xsVG9wKCkpICsgMTAgPj0gKCgkKGRvY3VtZW50KS5oZWlnaHQoKSkgLSAkKHdpbmRvdykuaGVpZ2h0KCkpKSB7XHJcbiAgICAgICAgZ2V0TGlzdE9mQWN0aXZlQXBpKFN0b3JlLmFjdGl2ZUFwaSlcclxuICAgIH1cclxufSk7XHJcblxyXG4kKCdib2R5Jykub24oJ2NsaWNrJywgJy5naWYnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBTdG9yZS5hY3RpdmVHaWYgPSB0aGlzLmlkO1xyXG4gICAgLy8gQVBJLmdldExpc3RJdGVtKCkgLy9ub3QgbWFraW5nIG5ldyByZXF1ZXN0IGFzIHJlbGF0ZWQgZGF0YSBpcyBhbHJlYWR5IGJvdW5kIHRvICdnaWYnXHJcbn0pO1xyXG5cclxuZ2V0VHJlbmRpbmdMaXN0KCkiXSwic291cmNlUm9vdCI6IiJ9